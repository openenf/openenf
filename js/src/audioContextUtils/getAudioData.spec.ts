import fs from "fs";
import path from "path";
import {getAudioData} from "./getAudioData";

describe('getAudioData', () => {
    it('can return correct data from wav file', async () => {
        const filepath = path.resolve("test/testAudio/large/608774__theplax__downstairs-in-boots-library_TRIM.wav");

        let buffer = fs.readFileSync(filepath);
        const result = await getAudioData(buffer,"");
        expect(Array.from(result[0]).slice(0,100)).toStrictEqual([
            -0.05023193359375, -0.049647118896245956,   -0.04402773082256317,
            -0.048284415155649185,  -0.05002744495868683,   -0.04683036729693413,
            -0.046374887228012085,   -0.0505211241543293,   -0.05334950238466263,
            -0.053141068667173386, -0.057050224393606186,   -0.06304910778999329,
            -0.06288862973451614,  -0.06509752571582794,    -0.0685759037733078,
            -0.07294386625289917,  -0.07720573246479034,   -0.08113357424736023,
            -0.08811110258102417,    -0.094467893242836,   -0.09397441893815994,
            -0.0946873277425766,  -0.10547123849391937,   -0.11510898172855377,
            -0.11327750980854034,  -0.11602450907230377,   -0.12891580164432526,
            -0.1309148073196411,   -0.1228535994887352,   -0.12794733047485352,
            -0.13528816401958466,   -0.1323157101869583,   -0.13459809124469757,
            -0.14557507634162903,  -0.14714974164962769,     -0.137815922498703,
            -0.14463961124420166,  -0.15545986592769623,   -0.15199892222881317,
            -0.1489214152097702,  -0.15822948515415192,     -0.163680300116539,
            -0.1521780788898468,  -0.15003229677677155,   -0.16395744681358337,
            -0.1680995374917984,  -0.15725542604923248,   -0.15644307434558868,
            -0.1665400266647339,   -0.1663614958524704,   -0.15984609723091125,
            -0.16020731627941132,   -0.1628214567899704,   -0.15763449668884277,
            -0.1487034410238266,   -0.1492803692817688,    -0.1461995393037796,
            -0.1375371217727661,  -0.13098248839378357,    -0.1315537989139557,
            -0.13117077946662903,  -0.12275664508342743,   -0.11511624604463577,
            -0.118438720703125,   -0.1177033931016922,     -0.109420046210289,
            -0.10668198019266129,  -0.10848729312419891,   -0.10905363410711288,
            -0.09816695004701614,   -0.0912388414144516,   -0.09428498893976212,
            -0.09398230910301208,  -0.08875176310539246,   -0.07998263090848923,
            -0.07725120335817337,   -0.0768650621175766,    -0.0672927126288414,
            -0.05975341796875,   -0.0576680488884449,   -0.05359094217419624,
            -0.05079245939850807,  -0.05081280693411827,   -0.04371902719140053,
            -0.0349818654358387,   -0.0399228036403656,   -0.03924622759222984,
            -0.022243577986955643, -0.022257070988416672,    -0.0350254587829113,
            -0.01859205588698387, 0.0037654254119843245,   -0.01753058470785618,
            -0.02431379072368145, 0.0003129491815343499, 0.00018784889834932983,
            -0.018893495202064514, -0.005143823567777872,    0.01835179701447487,
            0.0017166314646601677
        ]);
    })
})